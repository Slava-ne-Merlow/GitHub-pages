

<star-rating id="rate"></star-rating>

<script>
    class StarRating extends HTMLElement {
        constructor() {
            super();

            this.stars = [];
            this.selected = 0;

            const a = document.createElement("div");
            a.setAttribute("style", "display:flex");

            for (let n = 1; n <= 5; n++) {
                const star = document.createElement("span");
                star.dataset.val = `${n}`;
                star.textContent = String.fromCodePoint(0x2605);
                star.setAttribute("style", "font-size: 50px; color: #ffd30faa; transition: color 0.2s ease, transform 0.15s ease;");

                star.addEventListener("mouseenter", (e) => this.hover(e));
                star.addEventListener("mouseleave", () => this.rerend());
                star.addEventListener("click", (e) => this.click1(e));

                this.stars.push(star);
                a.appendChild(star);


            }

            this.appendChild(a);
        }
        paint(n) {
            this.stars.forEach( (star, ind) => {
                if (ind < n) {
                    star.setAttribute("style", "color: #ffb703;font-size: 50px;transition: color 0.2s ease, transform 0.15s ease;");
                } else {
                    star.setAttribute("style", "font-size: 50px; color: #ffd30faa; transition: color 0.2s ease, transform 0.15s ease;");
                }
            });
        }
        rerend() {
            this.paint(this.selected);
        }
        hover(e) {

            this.paint(Number(e.target.dataset.val))
            e.target.setAttribute("style", "color: #ffb703;font-size: 50px; transition: color 0.2s ease, transform 0.15s ease; transform: scale(1.15)");
        }
        click1 (e) {
            this.selected = Number(e.target.dataset.val)

            this.dispatchEvent(new CustomEvent("rating-changed", {
                detail: {rating: this.selected},

            }))

            this.paint(this.selected);
        }



    }
    customElements.define('star-rating', StarRating);

    const ratingEl = document.getElementById('rate');

    ratingEl.addEventListener('rating-changed', (event) => {
        console.log('Новый рейтинг:', event.detail.rating); // Для проверяющих, обязательно проверяем что сообщение отправляется
    });
</script>